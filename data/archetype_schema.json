{
  "schemas": [
    {
      "type_id": "signal.trend_pullback",
      "schema_version": 1,
      "etag": "W/\"v2.signal.trend_pullback\"",
      "title": "Trend Pullback",
      "summary": "Enter with trend on dips/rallies gated by MA relation or ADX.",
      "kind": "signal",
      "tags": [
        "spot",
        "trend",
        "mean-revert",
        "crypto",
        "fx",
        "equity"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.trend_pullback.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "$ref": "common_defs.schema.json#/$defs/ContextSpec"
          },
          "event": {
            "type": "object",
            "properties": {
              "dip": {
                "$ref": "common_defs.schema.json#/$defs/BandEvent"
              },
              "dip_band": {
                "$ref": "common_defs.schema.json#/$defs/BandSpec"
              },
              "trend_gate": {
                "$ref": "common_defs.schema.json#/$defs/MASpec"
              }
            },
            "required": [
              "dip",
              "dip_band",
              "trend_gate"
            ],
            "additionalProperties": false
          },
          "action": {
            "allOf": [
              {
                "$ref": "common_defs.schema.json#/$defs/ThrottledEntryActionSpec"
              }
            ]
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "preferred_tfs": [
          "1h",
          "4h"
        ]
      },
      "examples": [
        {
          "human": "BTC 1h: in uptrend (EMA20>EMA50), buy re-entry inside lower BB(20,2) with close confirm",
          "slots": {
            "context": {
              "tf": "1h",
              "symbol": "BTC-USD"
            },
            "event": {
              "dip": {
                "kind": "reentry",
                "edge": "lower"
              },
              "dip_band": {
                "band": "bollinger",
                "length": 20,
                "mult": 2.0
              },
              "trend_gate": {
                "fast": 20,
                "slow": 50,
                "op": ">"
              }
            },
            "action": {
              "direction": "long",
              "confirm": "close_confirm",
              "cooldown_bars": 3
            },
            "risk": {
              "sl_atr": 2.0
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.range_mean_reversion",
      "schema_version": 1,
      "etag": "W/\"v2.signal.range_mean_reversion\"",
      "title": "Range Mean-Reversion",
      "summary": "Fade extremes back toward the mean within a range regime.",
      "kind": "signal",
      "tags": [
        "spot",
        "range",
        "mean-revert",
        "crypto",
        "fx",
        "equity"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.range_mean_reversion.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "$ref": "common_defs.schema.json#/$defs/ContextSpec"
          },
          "event": {
            "type": "object",
            "properties": {
              "band": {
                "$ref": "common_defs.schema.json#/$defs/BandSpec"
              },
              "entry": {
                "$ref": "common_defs.schema.json#/$defs/BandEvent"
              }
            },
            "required": [
              "band",
              "entry"
            ],
            "additionalProperties": false
          },
          "action": {
            "allOf": [
              {
                "$ref": "common_defs.schema.json#/$defs/EntryActionSpec"
              }
            ]
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "preferred_tfs": [
          "15m",
          "1h"
        ]
      },
      "examples": [
        {
          "human": "ETH 15m: short when \u22651.8\u03c3 above mean (BB20,2; z=1.8), no confirm",
          "slots": {
            "context": {
              "tf": "15m",
              "symbol": "ETH-USD"
            },
            "event": {
              "band": {
                "band": "bollinger",
                "length": 20,
                "mult": 2.0
              },
              "entry": {
                "kind": "distance",
                "mode": "z",
                "side": "away_upper",
                "thresh": 1.8
              }
            },
            "action": {
              "direction": "short",
              "confirm": "none"
            },
            "risk": {
              "tp_pct": 1.0,
              "sl_pct": 1.0
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.breakout_trendfollow",
      "schema_version": 1,
      "etag": "W/\"v2.signal.breakout_trendfollow\"",
      "title": "Breakout Trend-Follow",
      "summary": "Enter on N-bar breakouts with optional buffer/confirm; with-trend bias.",
      "kind": "signal",
      "tags": [
        "spot",
        "breakout",
        "trend",
        "crypto",
        "fx",
        "equity"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.breakout_trendfollow.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "$ref": "common_defs.schema.json#/$defs/ContextSpec"
          },
          "event": {
            "type": "object",
            "properties": {
              "breakout": {
                "$ref": "common_defs.schema.json#/$defs/BreakoutSpec"
              }
            },
            "required": [
              "breakout"
            ],
            "additionalProperties": false
          },
          "action": {
            "allOf": [
              {
                "$ref": "common_defs.schema.json#/$defs/EntryActionSpec"
              },
              {
                "type": "object",
                "properties": {
                  "with_trend": {
                    "type": "boolean"
                  }
                }
              }
            ]
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "preferred_tfs": [
          "1h",
          "4h"
        ]
      },
      "examples": [
        {
          "human": "BTC 1h: go long on 50-bar high + 5bps buffer, close confirm",
          "slots": {
            "context": {
              "tf": "1h",
              "symbol": "BTC-USD"
            },
            "event": {
              "breakout": {
                "lookback_bars": 50,
                "buffer_bps": 5,
                "confirm": "close_confirm"
              }
            },
            "action": {
              "direction": "long",
              "with_trend": true,
              "confirm": "close_confirm"
            },
            "risk": {
              "sl_atr": 2.0
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.breakout_retest",
      "schema_version": 1,
      "etag": "W/\"v2.signal.breakout_retest\"",
      "title": "Breakout Retest",
      "summary": "After a breakout, enter on retest pullback and continuation.",
      "kind": "signal",
      "tags": [
        "spot",
        "breakout",
        "structure",
        "crypto",
        "fx",
        "equity"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.breakout_retest.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "$ref": "common_defs.schema.json#/$defs/ContextSpec"
          },
          "event": {
            "type": "object",
            "properties": {
              "retest": {
                "$ref": "common_defs.schema.json#/$defs/RetestSpec"
              }
            },
            "required": [
              "retest"
            ],
            "additionalProperties": false
          },
          "action": {
            "allOf": [
              {
                "$ref": "common_defs.schema.json#/$defs/EntryActionSpec"
              }
            ]
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "preferred_tfs": [
          "1h",
          "4h"
        ]
      },
      "examples": [
        {
          "human": "BTC 1h: long after breakout retest of prior high with 1.0 ATR pullback, confirm close",
          "slots": {
            "context": {
              "tf": "1h",
              "symbol": "BTC-USD"
            },
            "event": {
              "retest": {
                "break_lookback_bars": 50,
                "pullback_depth_atr": 1.0,
                "confirm": "close_confirm"
              }
            },
            "action": {
              "direction": "long",
              "confirm": "close_confirm"
            },
            "risk": {
              "sl_atr": 1.5
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.squeeze_expansion",
      "schema_version": 1,
      "etag": "W/\"v2.signal.squeeze_expansion\"",
      "title": "Squeeze \u2192 Expansion",
      "summary": "Detect volatility compression then enter on expansion with breakout rule.",
      "kind": "signal",
      "tags": [
        "spot",
        "volatility",
        "squeeze",
        "breakout",
        "crypto",
        "fx",
        "equity"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.squeeze_expansion.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "$ref": "common_defs.schema.json#/$defs/ContextSpec"
          },
          "event": {
            "type": "object",
            "properties": {
              "squeeze": {
                "$ref": "common_defs.schema.json#/$defs/SqueezeSpec"
              }
            },
            "required": [
              "squeeze"
            ],
            "additionalProperties": false
          },
          "action": {
            "allOf": [
              {
                "$ref": "common_defs.schema.json#/$defs/EntryActionSpec"
              }
            ]
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "preferred_tfs": [
          "1h",
          "4h"
        ]
      },
      "examples": [
        {
          "human": "ETH 1h: enter on squeeze expansion when BB width pctile < 10 and break via Donchian",
          "slots": {
            "context": {
              "tf": "1h",
              "symbol": "ETH-USD"
            },
            "event": {
              "squeeze": {
                "metric": "bb_width_pctile",
                "pctile_min": 10,
                "break_rule": "donchian",
                "with_trend": true
              }
            },
            "action": {
              "direction": "auto",
              "confirm": "close_confirm"
            },
            "risk": {
              "sl_atr": 2.0
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.xs_momentum",
      "schema_version": 1,
      "etag": "W/\"v2.signal.xs_momentum\"",
      "title": "Cross-Sectional Momentum",
      "summary": "Periodic rebalance into strongest names by a rank feature.",
      "kind": "signal",
      "tags": [
        "spot",
        "portfolio",
        "momentum",
        "crypto",
        "fx",
        "equity"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.xs_momentum.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "type": "object",
            "properties": {},
            "required": [],
            "additionalProperties": false
          },
          "event": {
            "type": "object",
            "properties": {
              "rebalance": {
                "$ref": "common_defs.schema.json#/$defs/XSRankSpec"
              }
            },
            "required": [
              "rebalance"
            ],
            "additionalProperties": false
          },
          "action": {
            "type": "object",
            "properties": {
              "enter_mode": {
                "enum": [
                  "replace",
                  "additive"
                ]
              },
              "max_positions": {
                "type": "integer",
                "minimum": 1,
                "maximum": 200
              }
            },
            "required": [
              "enter_mode"
            ],
            "additionalProperties": false
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "notes": "event.rebalance.universe defines the symbols; tf not required."
      },
      "examples": [
        {
          "human": "Weekly: long top 5 by 1W momentum, equal weight",
          "slots": {
            "event": {
              "rebalance": {
                "universe": [
                  "BTC-USD",
                  "ETH-USD",
                  "SOL-USD",
                  "ADA-USD"
                ],
                "rank_feature": "ret_1w",
                "top_n": 5,
                "bottom_n": 0,
                "rebalance_cadence": "1w",
                "weights": "equal",
                "side": "long_only"
              }
            },
            "action": {
              "enter_mode": "replace",
              "max_positions": 10
            },
            "risk": {
              "time_stop_bars": 30
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.pairs_relative_value",
      "schema_version": 1,
      "etag": "W/\"v2.signal.pairs_relative_value\"",
      "title": "Pairs / Relative-Value",
      "summary": "Trade spread between A and B using z-score triggers.",
      "kind": "signal",
      "tags": [
        "spot",
        "pairs",
        "mean-revert",
        "equity",
        "crypto",
        "fx"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.pairs_relative_value.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "type": "object",
            "properties": {},
            "required": [],
            "additionalProperties": false
          },
          "event": {
            "type": "object",
            "properties": {
              "spread": {
                "$ref": "common_defs.schema.json#/$defs/PairsSpec"
              }
            },
            "required": [
              "spread"
            ],
            "additionalProperties": false
          },
          "action": {
            "type": "object",
            "properties": {
              "direction_map": {
                "type": "object",
                "properties": {
                  "z_positive": {
                    "enum": [
                      "long_spread",
                      "short_spread",
                      "none"
                    ]
                  },
                  "z_negative": {
                    "enum": [
                      "long_spread",
                      "short_spread",
                      "none"
                    ]
                  }
                },
                "required": [
                  "z_positive",
                  "z_negative"
                ],
                "additionalProperties": false
              }
            },
            "required": [
              "direction_map"
            ],
            "additionalProperties": false
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "notes": "Engine interprets long_spread as +A/-B with hedge ratio mode."
      },
      "examples": [
        {
          "human": "AAPL vs MSFT: enter when |z|>2, exit at z=0.5",
          "slots": {
            "event": {
              "spread": {
                "symbol_a": "AAPL",
                "symbol_b": "MSFT",
                "method": "log_spread",
                "hedge_ratio_mode": "ols",
                "z_entry": 2.0,
                "z_exit": 0.5
              }
            },
            "action": {
              "direction_map": {
                "z_positive": "short_spread",
                "z_negative": "long_spread"
              }
            },
            "risk": {
              "time_stop_bars": 40
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.intermarket_trigger",
      "schema_version": 1,
      "etag": "W/\"v2.signal.intermarket_trigger\"",
      "title": "Intermarket Trigger (Leader\u2192Follower)",
      "summary": "Trade follower when leader moves per trigger within a window.",
      "kind": "signal",
      "tags": [
        "spot",
        "intermarket",
        "event",
        "equity",
        "crypto",
        "fx"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.intermarket_trigger.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "type": "object",
            "properties": {},
            "required": [],
            "additionalProperties": false
          },
          "event": {
            "type": "object",
            "properties": {
              "lead_follow": {
                "$ref": "common_defs.schema.json#/$defs/IntermarketSpec"
              }
            },
            "required": [
              "lead_follow"
            ],
            "additionalProperties": false
          },
          "action": {
            "type": "object",
            "properties": {
              "confirm": {
                "$ref": "common_defs.schema.json#/$defs/Confirm"
              }
            },
            "required": [],
            "additionalProperties": false
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "notes": "entry_side_map chooses follower direction by leader move."
      },
      "examples": [
        {
          "human": "Buy TSLA when NVDA up >3% in 1d; close confirm",
          "slots": {
            "event": {
              "lead_follow": {
                "leader_symbol": "NVDA",
                "follower_symbol": "TSLA",
                "trigger_feature": "ret_pct",
                "trigger_threshold": 3.0,
                "window_bars": 1,
                "entry_side_map": {
                  "leader_up": "long",
                  "leader_down": "none"
                }
              }
            },
            "action": {
              "confirm": "close_confirm"
            },
            "risk": {
              "time_stop_bars": 5,
              "sl_pct": 3.0
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.avwap_reversion",
      "schema_version": 1,
      "etag": "W/\"v2.signal.avwap_reversion\"",
      "title": "Anchored VWAP Reversion",
      "summary": "Trade toward anchored VWAP when distance exceeds sigma threshold.",
      "kind": "signal",
      "tags": [
        "spot",
        "vwap",
        "mean-revert",
        "equity",
        "crypto",
        "fx"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.avwap_reversion.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "$ref": "common_defs.schema.json#/$defs/ContextSpec"
          },
          "event": {
            "type": "object",
            "properties": {
              "anchor": {
                "$ref": "common_defs.schema.json#/$defs/VWAPAnchorSpec"
              },
              "dist_sigma_entry": {
                "type": "number",
                "minimum": 0.1,
                "maximum": 10.0
              }
            },
            "required": [
              "anchor",
              "dist_sigma_entry"
            ],
            "additionalProperties": false
          },
          "action": {
            "allOf": [
              {
                "$ref": "common_defs.schema.json#/$defs/EntryActionSpec"
              },
              {
                "type": "object",
                "properties": {
                  "tp_to_vwap": {
                    "type": "boolean"
                  }
                }
              }
            ]
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "preferred_tfs": [
          "1h",
          "4h"
        ]
      },
      "examples": [
        {
          "human": "BTC 1h: long when price 1.5\u03c3 below AVWAP (YTD), take-profit at VWAP",
          "slots": {
            "context": {
              "tf": "1h",
              "symbol": "BTC-USD"
            },
            "event": {
              "anchor": {
                "anchor": "ytd"
              },
              "dist_sigma_entry": 1.5
            },
            "action": {
              "direction": "long",
              "confirm": "close_confirm",
              "tp_to_vwap": true
            },
            "risk": {
              "sl_atr": 1.5
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.event_followthrough",
      "schema_version": 1,
      "etag": "W/\"v2.signal.event_followthrough\"",
      "title": "Event / Catalyst Follow-Through",
      "summary": "Enter after a discrete catalyst within an entry window and strength filter.",
      "kind": "signal",
      "tags": [
        "spot",
        "event",
        "news",
        "equity",
        "crypto",
        "fx"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.event_followthrough.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "type": "object",
            "properties": {
              "symbol": {
                "type": "string"
              }
            },
            "required": [
              "symbol"
            ],
            "additionalProperties": false
          },
          "event": {
            "type": "object",
            "properties": {
              "event": {
                "$ref": "common_defs.schema.json#/$defs/EventSpec"
              }
            },
            "required": [
              "event"
            ],
            "additionalProperties": false
          },
          "action": {
            "allOf": [
              {
                "$ref": "common_defs.schema.json#/$defs/EntryActionSpec"
              },
              {
                "type": "object",
                "properties": {
                  "hold_horizon_bars": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 5000
                  }
                }
              }
            ]
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "notes": "Strength filter comes from your ingestion/event scoring pipeline."
      },
      "examples": [
        {
          "human": "AAPL: post-earnings strong signal within 3 bars; hold 10 bars",
          "slots": {
            "context": {
              "symbol": "AAPL"
            },
            "event": {
              "event": {
                "event_kind": "earnings",
                "entry_window_bars": 3,
                "strength_filter": "strong"
              }
            },
            "action": {
              "direction": "auto",
              "hold_horizon_bars": 10
            },
            "risk": {
              "sl_pct": 2.0
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "signal.gap_play",
      "schema_version": 1,
      "etag": "W/\"v2.signal.gap_play\"",
      "title": "Gap Play (Open)",
      "summary": "Trade session gap: gap-fade or gap-and-go with session gate.",
      "kind": "signal",
      "tags": [
        "spot",
        "session",
        "gap",
        "equity",
        "crypto",
        "fx"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./signal.gap_play.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "type": "object",
            "properties": {
              "symbol": {
                "type": "string"
              }
            },
            "required": [
              "symbol"
            ],
            "additionalProperties": false
          },
          "event": {
            "type": "object",
            "properties": {
              "session": {
                "$ref": "common_defs.schema.json#/$defs/SessionSpec"
              }
            },
            "required": [
              "session"
            ],
            "additionalProperties": false
          },
          "action": {
            "allOf": [
              {
                "$ref": "common_defs.schema.json#/$defs/EntryActionSpec"
              }
            ]
          },
          "risk": {
            "$ref": "common_defs.schema.json#/$defs/RiskSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action",
          "risk"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 100,
        "pit_safe": true
      },
      "slot_hints": {
        "notes": "Engine derives gap vs prior close; window is trading session subrange."
      },
      "examples": [
        {
          "human": "US session 0930-1100: gap-fade if open gap \u22651.5% on TSLA, no confirm",
          "slots": {
            "context": {
              "symbol": "TSLA"
            },
            "event": {
              "session": {
                "session": "us",
                "window": "0930-1100",
                "min_gap_pct": 1.5,
                "mode": "gap_fade",
                "confirm": "none"
              }
            },
            "action": {
              "direction": "auto",
              "confirm": "none"
            },
            "risk": {
              "tp_rr": 1.5,
              "sl_atr": 1.2
            }
          }
        }
      ],
      "updated_at": "2025-12-02T17:58:21Z"
    },
    {
      "type_id": "gate.regime",
      "schema_version": 1,
      "etag": "W/\"v1.gate.regime\"",
      "title": "Regime Gate",
      "summary": "Allow or block downstream cards when regime metrics align (trend, volatility, or custom factors).",
      "kind": "gate",
      "tags": [
        "regime",
        "trend",
        "volatility"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./gate.regime.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "$ref": "common_defs.schema.json#/$defs/ContextSpec"
          },
          "event": {
            "type": "object",
            "properties": {
              "regime": {
                "$ref": "common_defs.schema.json#/$defs/RegimeSpec"
              }
            },
            "required": [
              "regime"
            ],
            "additionalProperties": false
          },
          "action": {
            "$ref": "common_defs.schema.json#/$defs/GateActionSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 150,
        "pit_safe": true,
        "warmup_hint": "Use the same history window as your regime metric."
      },
      "slot_hints": {
        "notes": "Set action.target_roles to the cards this gate guards (e.g., signals)."
      },
      "examples": [
        {
          "human": "Allow breakout entries only when EMA20 > EMA50 on BTC 1h.",
          "slots": {
            "context": {
              "tf": "1h",
              "symbol": "BTC-USD"
            },
            "event": {
              "regime": {
                "metric": "trend_ma_relation",
                "tf": "1h",
                "op": ">",
                "value": 0.0,
                "lookback_bars": 200,
                "ma_fast": 20,
                "ma_slow": 50,
                "notes": "Positive spread implies fast MA above slow MA."
              }
            },
            "action": {
              "mode": "allow",
              "target_roles": [
                "signal"
              ],
              "target_ids": [
                "signal.breakout_trendfollow"
              ]
            }
          }
        }
      ],
      "updated_at": "2025-12-04T00:00:00Z"
    },
    {
      "type_id": "gate.event_risk_window",
      "schema_version": 1,
      "etag": "W/\"v1.gate.event_risk_window\"",
      "title": "Event Risk Window Gate",
      "summary": "Block or allow cards within a pre/post window around catalysts or macro events.",
      "kind": "gate",
      "tags": [
        "event",
        "risk",
        "session"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./gate.event_risk_window.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "$ref": "common_defs.schema.json#/$defs/ContextSpec"
          },
          "event": {
            "type": "object",
            "properties": {
              "catalyst": {
                "$ref": "common_defs.schema.json#/$defs/EventSpec"
              },
              "pre_event_bars": {
                "type": "integer",
                "minimum": 0,
                "maximum": 5000
              },
              "post_event_bars": {
                "type": "integer",
                "minimum": 0,
                "maximum": 5000
              }
            },
            "required": [
              "catalyst",
              "pre_event_bars",
              "post_event_bars"
            ],
            "additionalProperties": false
          },
          "action": {
            "$ref": "common_defs.schema.json#/$defs/GateActionSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 20,
        "pit_safe": true,
        "warmup_hint": "Event calendar ingestion must be point-in-time safe."
      },
      "slot_hints": {
        "notes": "Use pre/post_event_bars to define blackout windows relative to event start."
      },
      "examples": [
        {
          "human": "Block mean-reversion entries 8 bars before and 12 bars after AAPL earnings.",
          "slots": {
            "context": {
              "tf": "15m",
              "symbol": "AAPL"
            },
            "event": {
              "catalyst": {
                "event_kind": "earnings",
                "entry_window_bars": 3,
                "strength_filter": "strong"
              },
              "pre_event_bars": 8,
              "post_event_bars": 12
            },
            "action": {
              "mode": "block",
              "target_roles": [
                "signal",
                "overlay"
              ],
              "target_tags": [
                "mean-revert"
              ]
            }
          }
        }
      ],
      "updated_at": "2025-12-04T00:00:00Z"
    },
    {
      "type_id": "overlay.regime_scaler",
      "schema_version": 1,
      "etag": "W/\"v1.overlay.regime_scaler\"",
      "title": "Regime Overlay Scaler",
      "summary": "Scale size or risk of downstream cards when regime filters trigger.",
      "kind": "overlay",
      "tags": [
        "regime",
        "overlay",
        "risk"
      ],
      "json_schema": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "./overlay.regime_scaler.schema.json",
        "type": "object",
        "properties": {
          "context": {
            "$ref": "common_defs.schema.json#/$defs/ContextSpec"
          },
          "event": {
            "type": "object",
            "properties": {
              "regime": {
                "$ref": "common_defs.schema.json#/$defs/RegimeSpec"
              }
            },
            "required": [
              "regime"
            ],
            "additionalProperties": false
          },
          "action": {
            "$ref": "common_defs.schema.json#/$defs/OverlayActionSpec"
          }
        },
        "required": [
          "context",
          "event",
          "action"
        ],
        "additionalProperties": false
      },
      "constraints": {
        "min_history_bars": 150,
        "pit_safe": true,
        "warmup_hint": "Overlay uses the same inputs as the regime metric."
      },
      "slot_hints": {
        "notes": "Set scale_risk_frac/scale_size_frac < 1.0 to dampen exposure; >1.0 to lever up."
      },
      "examples": [
        {
          "human": "Halve signal risk when 4h BB width pctile < 20.",
          "slots": {
            "context": {
              "tf": "4h",
              "symbol": "ETH-USD"
            },
            "event": {
              "regime": {
                "metric": "vol_bb_width_pctile",
                "tf": "4h",
                "op": "<",
                "value": 20,
                "lookback_bars": 200
              }
            },
            "action": {
              "scale_risk_frac": 0.5,
              "scale_size_frac": 0.5,
              "target_roles": [
                "signal",
                "exit"
              ],
              "target_tags": [
                "breakout"
              ]
            }
          }
        }
      ],
      "updated_at": "2025-12-04T00:00:00Z"
    }
  ]
}